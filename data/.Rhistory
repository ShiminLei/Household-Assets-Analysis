pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1.race<=pmse2
pmse2-pmse1.race
######################################
#3. 性别有没有影响
###############################################################
# 4.性别，学历的交叉作用
xdata.train.lm1 <-lm(asset^(L)~ (educ+white+age+kids)^2,data=xdata.data$train)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+educ+age+kids)^2,data=xdata.data$train)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
x <- seq(from=1, to=100, by=0.1)
y1 <- 2 + 3 * x +x^2
y2 <- 2 + 2 * x + 1.1 * x^2
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue')
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('Y1','Y2'))
xyplot(pred.lm1 ~ xdata.data$test$educ,type=c("p","r"))
xyplot(pred.lm2 ~ xdata.data$test$educ,type=c("p","r"))
###############################################################
# 5.学历，年龄 的交叉作用
#######################################################
#测试集分布好
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
boxasset <- boxplot(xdata$kids,xdata.data$train$kids,xdata.data$test$kids,names=c('original','train','test'),main="assets",pch=1)
################################################
#data <- data1[,c("education","sex","race","age","nown","ntrad","kids","asset")]
# hhsex: 1 表示 male   2表示female
# educ : 大于9 表示大学学历，其余表示非大学学历
# kids : 孩子的数量
# race : 1 white  2 black 3 hispanic 5 other
# nbusveh  Total number of owned vehicles
# ntrad       number of trades per year
# nown        number of owned vehicles
uva.pairs(xdata[,c("educ","age","ntrad","kids","asset")])
xdata$logasset <- log(xdata$asset)
biplot(pred.pca)
screeplot(pred.pca, main = "Variance for PC of Metrics")
pred.pca <- princomp(xdata[,c("educ","age","ntrad","kids","asset")],cor=T)
biplot(pred.pca)
screeplot(pred.pca, main = "Variance for PC of Metrics")
biplot(pred.pca)
interaction.plot(xdata$f_aage,xdata$f_kid,log(xdata$asset),xlab="aweqw",ylab="qwe")
library(RColorBrewer)
n <- 4
color <- brewer.pal(n,"Set1")
barplot(table(xdata$f_hhsex),col=color)
barplot(table(xdata$f_race),col=color, beside=F)
barplot(table(xdata$f_hhsex),col=color)
barplot(table(xdata$f_race),col=color, beside=F)
barplot(table(xdata$f_hhsex),col=color)
barplot(table(xdata$f_race),col=color, beside=F)
uxdata <- data[data$asset<=assetbox$stats[1],]
myImagePlot(table(xdata$f_hhsex, xdata$f_race), title = "No. of Households with High Asset by Sex and Race")
myImagePlot(table(xdata$f_hhsex, xdata$f_race), title = "No. of Households with High Asset by Sex and Race")
xyplot(log(asset)~age|f_eeduc*f_hhsex,data=xdata,type=c("p","r"))
xyplot(log(asset)~age|f_eeduc*work,data=xdata,type=c("p","r"))
xyplot(log(asset)~age|f_eeduc*f_hhsex,data=xdata,type=c("p","r"))
xyplot(log(asset)~age|f_eeduc*work,data=xdata,type=c("p","r"))
xyplot(log(asset)~age|f_eeduc*f_hhsex,data=xdata,type=c("p","r"))
xyplot(log(asset)~age|f_eeduc*work,data=xdata,type=c("p","r"))
lm1 <- lm(asset~man+white+work+educ+age+kids,data=xdata)
summary(lm1)
summary(lm1)$adj.r.squared
summary(lm2)$adj.r.squared
summary(lm3)$adj.r.squared
summary(lm4)
View(uxdata)
summary(lm4)
summary(lm4)$adj.r.squared
summary(lm4)
summary(lm4)$adj.r.squared
par(mfrow=c(2,2))
plot(lm4,labels.id = NULL)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
par(mfrow=c(2,2))
plot(lm4,labels.id = NULL)
plot(lm4,labels.id = NULL,which=4)
xdata[1797,]
par(mfrow=c(1,1))
plot(lm4,labels.id = NULL,which=4)
xdata[1797,c("educ","age","ntrad","kids","asset","work")]
xdata[102,c("educ","age","ntrad","kids","asset","work")]
xdata[102,c("educ","age","ntrad","kids","asset","work")]
summary(lm4)
test.size <- 1/3
xdata.data <- test.set(xdata,test.size)
par(mfrow=c(2,2))
hist(xdata.data$train$asset)
hist(xdata.data$test$asset)
hist(xdata$asset)
par(mfrow=c(1,1))
age.lm1 <- lm(asset~man+white+work+educ+kids,data=xdata)
anova(age.lm1,lm1)
age.lm4 <- lm(asset^(L)~(man+white+work+educ+kids)^2,data=xdata)
anova(age.lm4,lm4)
anova(age.lm4,lm4)
summary(lm4)
summary(lm4)$adj.r.squared
summary(age.lm4)$adj.r.squared
lm1 <- lm(asset~man+white+work+educ+age+kids,data=xdata)
summary(lm1)
summary(lm4)
man.lm1 <- lm(asset~ white+work+educ+age+kids,data=xdata)
anova(man.lm1,lm1)
man.lm4 <- lm(asset^(L)~(white+work+educ+age+kids)^2,data=xdata)
anova(man.lm4,lm4)
man.lm4 <- lm(asset^(L)~(white+work+educ+age+kids)^2,data=xdata)
summary(lm4)
anova(man.lm4,lm4)
man.lm4 <- lm(asset^(L)~(white+man+work+age+kids)^2,data=xdata)
anova(man.lm4,lm4)
man.lm4 <- lm(asset^(L)~(white+educ+work+age+kids)^2,data=xdata)
anova(man.lm4,lm4)
man.lm1 <- lm(asset~ white+work+educ+age+kids,data=xdata)
anova(man.lm1,lm2step)
man.lm1 <- lm(asset^(L)~ white+work+educ+age+kids,data=xdata)
anova(man.lm1,lm2step)
man.lm4 <- lm(asset^(L)~(white+educ+work+age+kids)^2,data=xdata)
anova(man.lm4,lm4)
summary(lm4)
summary(man.lm4)$adj.r.squared
summary(lm3)
summary(lm2)
age.lm1 <- lm(asset^(L)~man+white+work+educ+kids,data=xdata)
anova(age.lm1,lm1)
age.lm1 <- lm(asset^(L)~man+white+work+educ+kids,data=xdata)
anova(age.lm1,lm2step)
summary(lm4)$adj.r.squared
summary(age.lm4)$adj.r.squared
anova(age.lm4,lm4)
man.lm1 <- lm(asset^(L)~ white+work+educ+age+kids,data=xdata)
anova(man.lm1,lm2step)
man.lm4 <- lm(asset^(L)~(white+educ+work+age+kids)^2,data=xdata)
man.lm4.step <- step(man.lm4)
anova(man.lm4,lm4)
anova(man.lm4.step,lm4)
summary(man.lm4.step)$adj.r.squared
man.lm4 <- lm(asset^(L)~(white+educ+work+age+kids)^2,data=xdata)
man.lm4.step <- step(man.lm4)
anova(man.lm4.step,lm4)
summary(lm4)
summary(lm4)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue')
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('Y1','Y2'))
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
x <- seq(from=1, to=100, by=0.1)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue')
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
interaction.plot(xdata$f_hhsex,xdata$f_eeduc,log(xdata$asset),xlab="aweqw",ylab="qwe")
interaction.plot(xdata$f_aage,xdata$f_kid,log(xdata$asset),xlab="aweqw",ylab="qwe")
interaction.plot(xdata$f_eeduc,xdata$f_kid,log(xdata$asset),xlab="aweqw",ylab="qwe")
interaction.plot(xdata$f_hhsex,xdata$f_race,log(xdata$asset),xlab="aweqw",ylab="qwe")
summary(lm4)
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue')
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xyplot(pred.lm1 ~ xdata.data$test$educ,type=c("p","r"))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
xlab="aaa"
xlab="aaa"
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm11 <-lm(asset^(L)~ educ+white+work+age+kids,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ man+white+work+educ+age+kids,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm11 <-lm(asset^(L)~ educ+white+work+age+kids,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ man+white+work+educ+age+kids,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
x <- seq(from=1, to=100, by=0.1)
y1 <- 2 + 3 * x +x^2
y2 <- 2 + 2 * x + 1.1 * x^2
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
summary(lm4)
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
plot(smooth.spline(xdata.data$test$age,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$age,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$edcu,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$edcu,pred.lm1),type='l',col='blue',xlab = "level of education")
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm1 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
x <- seq(from=1, to=100, by=0.1)
y1 <- 2 + 3 * x +x^2
y2 <- 2 + 2 * x + 1.1 * x^2
plot(smooth.spline(xdata.data$test$edcu,pred.lm1),type='l',col='blue',xlab = "level of education")
plot(smooth.spline(xdata.data$test$eduu,pred.lm1),type='l',col='blue',xlab = "level of education")
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
title(xlab= "the level of education", ylab = "assets^(-0.3)")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(xlab= "the level of education", ylab = "assets^(-0.3)")
title(main="111",xlab= "the level of education", ylab = "assets^(-0.3)")
title(main="111",xlable= "the level of education", ylab = "assets^(-0.3)")
plot(1:30, main="图形元素设置演示图", ylab="y轴数值", xlab="x轴数值")
plot(1:30, main="图形元素设置演示图", ylab="y轴数值", xlab="x轴数值")
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(main="111",xlable= "the level of education", ylab = "assets^(-0.3)")
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(xlable= "the level of education", ylab = "assets^(-0.3)")
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
pred.lm1 <- pred.lm11^(L)
pred.lm2 <- pred.lm21^(L)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(L)
pred.lm2 <- pred.lm21^(L)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(xlable= "the level of education", ylab = "assets^(-0.3)")
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm1 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(L)
pred.lm2 <- pred.lm21^(L)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(xlable= "the level of education", ylab = "assets^(-0.3)")
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm1 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(L)
pred.lm2 <- pred.lm21^(L)
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
x <- seq(from=1, to=100, by=0.1)
y1 <- 2 + 3 * x +x^2
y2 <- 2 + 2 * x + 1.1 * x^2
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
pred.lm1 <- pred.lm11^(1/L)
pred.lm2 <- pred.lm21^(1/L)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
title(xlable= "the level of education", ylab = "assets^(-0.3)")
title(xlab= "the level of education", ylab = "assets^(-0.3)")
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xyplot(pred.lm1 ~ xdata.data$test$educ,type=c("p","r"))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
summary(lm4)
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(1/L)
pred.lm2 <- pred.lm21^(1/L)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(1/L)
pred.lm2 <- pred.lm21^(1/L)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(1/L)
pred.lm2 <- pred.lm21^(1/L)
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
pmse1
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1<=pmse2
pmse2-pmse1
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
xdata.train.lm11 <-lm(asset^(L)~ (educ+white+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm21 <-lm(asset^(L) ~ (man+white+work+educ+age+kids)^2,data=xdata.data$train)
xdata.train.lm1 <-step(xdata.train.lm11)
xdata.train.lm2 <-step(xdata.train.lm21)
pred.lm11 <- predict(xdata.train.lm1,newdata=xdata.data$test )
pred.lm21 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pred.lm1 <- pred.lm11^(1/L)
pred.lm2 <- pred.lm21^(1/L)
pmse1 <- mse(pred.lm1,xdata.data$test$asset)
plot(smooth.spline(xdata.data$test$educ,pred.lm1),type='l',col='blue',xlab = "level of education")
points(smooth.spline(xdata.data$test$educ,pred.lm2),type='l',col='red')
legend('topleft',col=c('blue','red'),lty=1,legend=c('mo man','man'))
summary(lm4)
anova(age.lm1,lm2step)
summary(lm4)
anova(age.lm1,lm2step)
summary(lm2)
anova(age.lm4,lm4)
age.lm4.step <- step(age.lm4)
anova(age.lm4,lm4)
anova(age.lm4.step,lm4)
summary(lm4)
summary(lm4)
summary(lm4)
test.size <- 1/3
xdata.data <- test.set(xdata,test.size)
par(mfrow=c(2,2))
hist(xdata.data$train$asset)
hist(xdata.data$test$asset)
hist(xdata$asset)
par(mfrow=c(1,1))
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
boxasset <- boxplot(xdata$kids,xdata.data$train$kids,xdata.data$test$kids,names=c('original','train','test'),main="assets",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
par(mfrow(c(2,2)))
par(mfrow=(c(2,2)))
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
par(mfrow=(c(2,2)))
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
par(mfrow=(c(1,1)))
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
par(mfrow=(c(2,2)))
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
boxasset <- boxplot(xdata$kids,xdata.data$train$kids,xdata.data$test$kids,names=c('original','train','test'),main="assets",pch=1)
boxasset <- boxplot(xdata$man,xdata.data$train$man,xdata.data$test$man,names=c('original','train','test'),main="assets",pch=1)
boxasset <- barchart(xdata$man,xdata.data$train$man,xdata.data$test$man,names=c('original','train','test'),main="assets",pch=1)
which(xdata$man==1
which(xdata$man==1)
which(xdata$man)==1
which(xdata$man==1)
length(which(xdata$man==1))
barplot(matrix(c(length(xdata$man==1)/length(which(xdata$man==1)), (length(spam$V58)-sum(spam$V58))/length(spam$V58), sum(Spam$train$V58)/length(Spam$train$V58), (length(Spam$train$V58)-sum(Spam$train$V58))/length(Spam$train$V58),sum(Spam$test$V58)/length(Spam$test$V58), (length(Spam$test$V58)-sum(Spam$test$V58))/length(Spam$test$V58) ), nrow = 2, byrow = F, dimnames = list(NULL, c("Full", "Train", "Test"))), beside = F, col = c("mistyrose", "lightblue"))
barplot(matrix(c(length(xdata$man==1)/length(which(xdata$man==1)), (length(xdata$man==1)/length(which(xdata$man==1)), (length(xdata$man==1)/length(which(xdata$man==1)), (length(xdata$man==1)/length(which(xdata$man==1))) nrow = 2, byrow = F, dimnames = list(NULL, c("Full", "Train", "Test"))), beside = F, col = c("mistyrose", "lightblue"))
length(which(xdata$man==1))
(length(xdata$man==1)/length(which(xdata$man==1)
length(which(xdata$man==1))
length(xdata$man==1)/length(which(xdata$man==1)
length(which(xdata$man==1))
length(which(xdata$man==1))
which(xdata$man==1
which(xdata$man==1)
which(xdata$man==1)
barplot(xdata$man,xdata$man[which(xdata$man==1),])
xdata$man[which(xdata$man==1),]
barplot(xdata$man,xdata$man[xdata$man==1,])
xdata$man
barplot(xdata$man,xdata[xdata$man==1,])
xdata[xdata$man==1,]
barplot(matrix(c(length(which(xdata$man==1))/length(xdata$man==1),(length(xdata$man==1)-length(which(xdata$man==1)))/length(xdata$man==1)),nrow = 2, byrow = F, dimnames = list(NULL, c("Full", "Train", "Test"))), beside = F, col = c("mistyrose", "lightblue"))
pie(c(1,2,3))
par(mfrow=(c(3,1)))
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
boxasset <- boxplot(xdata$kids,xdata.data$train$kids,xdata.data$test$kids,names=c('original','train','test'),main="assets",pch=1)
boxasset <- boxplot(xdata$asset,xdata.data$train$asset,xdata.data$test$asset,names=c('original','train','test'),main="assets",pch=1)
par(mfrow=(c(3,1)))
boxasset <- boxplot(xdata$educ,xdata.data$train$educ,xdata.data$test$educ,names=c('original','train','test'),main="educ",pch=1)
boxasset <- boxplot(xdata$age,xdata.data$train$age,xdata.data$test$age,names=c('original','train','test'),main="age",pch=1)
boxasset <- boxplot(xdata$kids,xdata.data$train$kids,xdata.data$test$kids,names=c('original','train','test'),main="kids",pch=1)
x <- c(length(which(xdata$man==1)), (length(xdata$man==1)-length(which(xdata$man==1))))
labels <- c("man", "woman")
pie(x)
labels <- c("man", "woman")
pie(x)
xdata.train.race.lm1 <-lm(asset^(L)~ (man+edcu+work+age+kids)^2,data=xdata.data$train)
xdata.train.race.lm1 <-lm(asset^(L)~ (man+educ+work+age+kids)^2,data=xdata.data$train)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+educ+work+age+kids)^2,data=xdata.data$train)
pred.race.lm1 <- predict(xdata.train.race.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1.race <- mse(pred.race.lm1,xdata.data$test$asset)
pmse1.race
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1.race<=pmse2
pmse1.race<=pmse2
pmse2-pmse1.race
pmse1.race<=pmse2
xdata.train.kidsage.lm1 <-lm(asset^(L)~ (man+white+educ+work+age+kids)^2-kids*age,data=xdata.data$train)
summary(xdata.train.kidsage.lm1)
xdata.train.kidsage.lm1 <-lm(asset^(L)~ (man+white+educ+work+age+kids)^2-kids*age,data=xdata.data$train)
xdata.train.lm2 <-lm(asset^(L) ~ (man+white+educ+work+age+kids)^2,data=xdata.data$train)
summary(xdata.train.kidsage.lm1)
pred.kidsage.lm1 <- predict(xdata.train.kidsage.lm1,newdata=xdata.data$test )
pred.lm2 <- predict(xdata.train.lm2,newdata=xdata.data$test )
pmse1.kidsage <- mse(pred.race.lm1,xdata.data$test$asset)
pmse1.kidsage
pmse2 <- mse(pred.lm2,xdata.data$test$asset)
pmse2
pmse1.kidsage<=pmse2
pmse2-pmse1.kidsage
pmse1.kidsage<=pmse2
pmse2-pmse1.kidsage
summary(lm4)
summary(lm2)
summary(lm1)
summary(lm2)
biplot(pred.pca)
par(mfrow=(c(1,1)))
biplot(pred.pca)
